{"name":"Configurine","tagline":"A Node JS application that provides a REST interface for managing and retrieving config values","body":"configurine\r\n===\r\n\r\n[![Build Status](https://secure.travis-ci.org/mac-/configurine.png)](http://travis-ci.org/mac-/configurine)\r\n[![Dependency Status](https://david-dm.org/mac-/configurine.png)](https://david-dm.org/mac-/configurine)\r\n\r\nConfigurine is a Node JS application that provides a REST interface for managing and retrieving config values. Configurine currently uses MongoDB for storing config values, and provides a RESTful API for retrieving values from the DB. The system allows you to \"associate\" your config values to either environments or applications, or both.\r\n\r\nFor example, you could have two config values named \"myConfig\", and each one is associated to a different environment (development/production) or to a different application (myapp-v1/myapp-v2).\r\n\r\nThis centralized system provides an easy mechanism for using application-specific or environment-specific config for all of your applications, regardless of what technology they are using.\r\n\r\nGoals\r\n===\r\n* should be available to both client and server apps\r\n* should be able to act as a centralized system\r\n* should be easy to add/change values (REST interface)\r\n* should allow multiple values with the same name\r\n* management of config can be automated with scripts or through a nice GUI\r\n\r\nThe Design\r\n===\r\n\r\nConfig Entries\r\n---\r\n\r\nConfig documents will mainly be accessed by name. A config document consists of the following properties:\r\n\r\n* name: The name of the config entry that comsumers will request values by\r\n* value: The value of the config entry that contains the data necessary for consumers\r\n* associations: A collection of associations that describe the relationships to environments and applications\r\n* isActive: A flag that marks whether or not this config entry is available to consumers\r\n* isSensitive: A flag that marks whether or not this config entry requires authentication in order to be available to conumers\r\n\r\nThe Database\r\n---\r\n\r\nThere are four Mongo collections used in Confgurine that are required. The first collection is called \"config\" and stores the actual config values. The second is called \"configUsers\" and stores the credentials of users who can manage the system. The last collection is called \"configTagTypes\" and contains all the available tag types and thier priorities. The fourth collection is called \"history\" and stores a history of each change to a given config document. There is one last optional collection called \"logs\" if you choose to write your logs to Mongo.\r\n\r\n\r\nInstallation\r\n===\r\n\r\nYou'll need:\r\n\r\n* a non-windows machine that has [Node](http://nodejs.org/) installed in order to run the application.\r\n* a MongoDB instance\r\n\r\nPull down the source code and run the tests to make sure everything you are in a good state:\r\n\r\n\t$ git clone git@github.com:mac-/configurine.git\r\n\t$ cd configurine\r\n\t$ make install\r\n\t$ make test\r\n\r\n\r\n\r\nRunning the Tests\r\n===\r\n\r\nConfigurine comes with a set of unit tests, and a set of automated integration tests. To run the unit tests run the following command:\r\n\r\n\t$ make test\r\n\r\nTo run the integration tests, you'll need a Mongo DB instance set up since the test invokes the application, and change the values in tests/integrationTestConfig.json to match your setup. Then you can run the tests with the following command:\r\n\r\n\t$ make integration\r\n\r\nRunning the App\r\n===\r\n\r\nYou can run configurine with the -h flag to see the various options:\r\n\r\n\t$ node app.js -h\r\n\t  Usage: app.js [options]\r\n\r\n\t  Options:\r\n\r\n\t    -h, --help                          output usage information\r\n\t    -V, --version                       output the version number\r\n\t    -l, --listen-port <port>            The port that the application will listen for incoming HTTP requests on. Defaults to: 8088\r\n\t    -n, --number-processes <number>     The number of processes to use for this application. Defaults to: 1\r\n\t    -o, --database-host <host>          The MongoDB host that this should connect to (hostname and port). This can also be a comma-separated list of hosts to support a replica set. Defaults to: \"127.0.0.1:27017\"\r\n\t    -u, --database-user <user>          The user name to use when connecting to MongoDB.\r\n\t    -p, --database-password <password>  The password to use when connecting to MongoDB.\r\n\t    -t, --log-transport <type>          The transport to use for logging. Valid options are none, console, file, and mongo. If file is chosen, logs will be written to /var/log/configurine.log (make sure you use a program like logrotate to manage your log files). If mongo is chosen, logs will be written to the configurine database in the logs collection. Defaults to: \"none\"\r\n\t    -g, --log-level <level>             The level to log at. Can be a number 0-5 or the following strings: log, trace, debug, info, warn, and error. Defaults to: 0\r\n\t    -s, --statsd-host <host>            The statsd host (hostname and port) where metrics can be sent. Defaults to: \"127.0.0.1:8125\"\r\n\r\n\r\n\r\nExample usage:\r\n\r\n\t$ node app.js -o my.mongo.instance:27017 -u admin -p password\r\n\r\nYou may also specify values for the options in env variables. The format of the option name is camelcase with dashes removed (so \"log-level\" would be \"logLevel\"). If a value is specified in both env vars and the command line args, the env vars value will take precedence.\r\n\r\nUsing the App\r\n===\r\n\r\nMain API\r\n---\r\n\r\nThe main end point that your applications will be using is:\r\n\r\n\tGET /config\r\n\r\nThis rend point, by itself, will return all config entries in the system. To filter the result to something more managable, ther are a few query string parameters that you can specify:\r\n\r\n* ```names```\r\n\t* The ```names``` query string parameter will filter the result to only include config entries with the names you specify\r\n\t* Example: ```GET /config?names=statsd&names=loglevel``` will return results that have the name \"statsd\" OR \"loglevel\"\r\n* ```associations```\r\n\t* The ```associations``` query string parameter will filter the result to only include config entries with the associations you specify\r\n\t* Application associations are specified in the format of ```application|<appName>|<appVersion>```\r\n\t* Environment associations are specified in the format of ```environment|<envName>```\r\n\t* Example: ```GET /config?associations=environment|production&associations=application|myapp|1.0.0``` will return results that have an association to the application named \"myapp\" whose version is \"1.0.0\" OR an environment named \"production\"\r\n* ```isActive```\r\n\t* the ```isActive``` query string parameter will filter the result to only include config entries that have the ```isActive``` flag set to the specifed boolean value\r\n\t* Example: ```GET /config?isActive=true``` will return results that have the ```isActive``` property set to true\r\n\r\nIt is also possible to mix and match these parameters as you see fit to get the result you want. It is possible that the results of these requests to contain config entries with the same name. Therefore it is up to the consumer to provide the logic for parsing out the values that their application should consume. For example, A request to ```GET /config?names=loglevel``` could return the following result:\r\n\r\n\t[{\r\n\t\t\"name\": \"loglevel\",\r\n\t\t\"value\": \"error\",\r\n\t\t\"associations\": {\r\n\t\t\t\"applications\": [{\r\n\t\t\t\t\"name\": \"myapp\",\r\n\t\t\t\t\"version\": \"1.0.0\"\r\n\t\t\t}],\r\n\t\t\t\"environments\": []\r\n\t\t},\r\n\t\t\"isSensitive\": false,\r\n\t\t\"isActive\": true\r\n\t}, {\r\n\t\t\"name\": \"loglevel\",\r\n\t\t\"value\": \"info\",\r\n\t\t\"associations\": {\r\n\t\t\t\"applications\": [{\r\n\t\t\t\t\"name\": \"myapp\",\r\n\t\t\t\t\"version\": \"2.0.0\"\r\n\t\t\t}],\r\n\t\t\t\"environments\": []\r\n\t\t},\r\n\t\t\"isSensitive\": false,\r\n\t\t\"isActive\": true\r\n\t}]\r\n\r\nAs you can see, there are multiple values for the config entry named \"loglevel\". Therefore it is up to the application to decide which one to use. In this case, if my application is named \"myapp\", then I may want to just change the GET request to incorporate the query string parameter for associations to narrow down the results so that my application doesn't have to do as much work to determine which value to use. For example, I could change the request to ```GET /config?names=loglevel&associations=application|myapp|2.0.0``` to narrow the result down to one entry.\r\n\r\n\r\nAuthentication\r\n===\r\n\r\nThese routes require [basic authentication](http://en.wikipedia.org/wiki/Basic_access_authentication). So an example curl request might look like:\r\n\r\n\t$ curl -u user:user 'http://127.0.0.1:8088/configEntries/502fd3839702c7f81e000001'\r\n\r\n\r\nLicense\r\n===\r\nThe MIT License (MIT) Copyright (c) 2012 Mac Angell\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}